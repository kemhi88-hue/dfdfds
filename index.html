<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>VSPhone ‚Äì Qu·∫£n l√Ω & T·ª± ƒë·ªông h√≥a</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f4f7f9; color: #333; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        
        /* Khu v·ª±c nh·∫≠p Token m√†u v√†ng ƒë·ªÉ n·ªïi b·∫≠t */
        .token-box { background: #fff3cd; padding: 15px; border: 1px solid #ffeeba; border-radius: 5px; margin-bottom: 20px; }
        .config-box { background: #e9ecef; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 5px solid #28a745; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #dee2e6; padding: 12px; text-align: left; }
        th { background: #f8f9fa; }
        
        .btn { padding: 8px 15px; background: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
        .btn-run { background: #28a745; font-weight: bold; width: 100%; margin-top: 10px; }
        
        input { padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 5px; }
        .input-group { display: flex; flex-direction: column; gap: 5px; max-width: 300px; }
    </style>
</head>
<body>

<div class="container">
    <h2>VSPhone ‚Äì B·∫£ng ƒëi·ªÅu khi·ªÉn</h2>

    <div class="token-box">
        <strong>üîë B∆∞·ªõc 1: X√°c th·ª±c GitHub</strong><br>
        <p style="font-size: 0.85em; margin: 5px 0;">D√°n Personal Access Token (classic) c√≥ quy·ªÅn 'repo' v√† 'workflow' v√†o ƒë√¢y.</p>
        <input type="password" id="gh_token_ui" placeholder="ghp_xxxxxxxxxxxx" style="width: 100%; max-width: 500px;">
    </div>

    <div class="config-box">
        <strong>üöÄ B∆∞·ªõc 2: ƒêƒÉng k√Ω Ref t·ª± ƒë·ªông</strong>
        <div class="input-group" style="margin-top:10px;">
            <input type="text" id="reg_email" placeholder="Email ƒëƒÉng k√Ω m·ªõi">
            <input type="text" id="reg_pass" placeholder="M·∫≠t kh·∫©u mong mu·ªën">
            <input type="text" id="reg_ref" placeholder="M√£ m·ªùi (Ref Code)" value="NH·∫¨P_M√É_T·∫†I_ƒê√ÇY">
            <button class="btn btn-run" onclick="startAutoRegister()">K√çCH HO·∫†T M√ÅY ·∫¢O CH·∫†Y TOOL</button>
        </div>
    </div>

    <table id="accountTable">
        <thead>
            <tr>
                <th>#</th>
                <th>Email</th>
                <th>Password</th>
                <th>Tr·∫°ng th√°i</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <tr><td colspan="4">ƒêang t·∫£i d·ªØ li·ªáu...</td></tr>
        </tbody>
    </table>
</div>

<script>
async function startAutoRegister() {
    const token = document.getElementById('gh_token_ui').value.trim();
    const email = document.getElementById('reg_email').value.trim();
    const password = document.getElementById('reg_pass').value.trim();
    const ref = document.getElementById('reg_ref').value.trim();

    if (!token) { return alert("Vui l√≤ng nh·∫≠p GitHub Token!"); }
    if (!email || !password) { return alert("Vui l√≤ng nh·∫≠p Email v√† Password!"); }

    const OWNER = "kemhi88-hue";
    const REPO = "dfdfds";

    try {
        const response = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/dispatches`, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${token}`,
                'Accept': 'application/vnd.github.v3+json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                event_type: 'run-tool',
                client_payload: { email, password, ref }
            })
        });

        if (response.status === 204) {
            alert("‚úÖ L·ªánh g·ª≠i th√†nh c√¥ng! H√£y ki·ªÉm tra tab Actions tr√™n GitHub.");
        } else {
            const err = await response.json();
            alert("‚ùå L·ªói " + response.status + ": " + err.message);
        }
    } catch (e) {
        alert("‚ùå L·ªói k·∫øt n·ªëi API!");
    }
}

// Gi·ªØ nguy√™n h√†m loadSheet c·ªßa b·∫°n ƒë·ªÉ hi·ªán b·∫£ng
async function loadSheet() {
    const SHEET_URL = 'https://opensheet.elk.sh/1fU4ppbOWDikPkEWUdXiyqrUn8JHXvt-PJjS778J-R8M/Trang%20t%C3%ADnh1';
    try {
        const res = await fetch(SHEET_URL);
        const data = await res.json();
        const tbody = document.querySelector('#tbody');
        tbody.innerHTML = '';
        data.forEach((row, i) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${i+1}</td><td>${row.email}</td><td>${row.password}</td><td>${row.status || 'S·∫µn s√†ng'}</td>`;
            tbody.appendChild(tr);
        });
    } catch (e) { console.error(e); }
}
loadSheet();
</script>
</body>
</html>
