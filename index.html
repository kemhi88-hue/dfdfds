<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>VSPhone ‚Äì Qu·∫£n l√Ω t√†i kho·∫£n</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #fff;
  color: #000;
  padding: 20px;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}
th {
  background: #eee;
}
.btn {
  padding: 4px 10px;
  background: #007bff;
  color: #fff;
  border: none;
  cursor: pointer;
}
.btn:hover {
  background: #0056b3;
}
.password-cell {
  font-family: monospace;
}
</style>
</head>

<body>

<h2>VSPhone ‚Äì Qu·∫£n l√Ω t√†i kho·∫£n</h2>
<p>D·ªØ li·ªáu load tr·ª±c ti·∫øp t·ª´ Google Sheets.</p>

<table id="accountTable">
  <thead>
    <tr>
      <th>#</th>
      <th>N·ªÅn t·∫£ng</th>
      <th>Email</th>
      <th>Password</th>
      <th>Tr·∫°ng th√°i</th>
      <th>Thao t√°c</th>
    </tr>
  </thead>
  <tbody id="tbody">
    <tr><td colspan="6">ƒêang t·∫£i d·ªØ li·ªáu...</td></tr>
  </tbody>
</table>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
const CSV_URL =
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vSyIS6NTiGHKz7BR5e8PEshKhRJWJcUC9bR8Gp5_WuqfsEGOwRdaARGcR-CwV7Dn_gUYRxcZ12Yb20I/pub?output=csv';

function escapeHtml(str) {
  return String(str ?? '')
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;");
}

async function loadSheet() {
  try {
    const res = await fetch(CSV_URL);
    const csvText = await res.text();

    const parsed = Papa.parse(csvText, {
      header: true,
      skipEmptyLines: true
    });

    console.log('[CSV DATA]', parsed.data);
    renderTable(parsed.data);

  } catch (err) {
    console.error(err);
    document.getElementById('tbody').innerHTML =
      `<tr><td colspan="6">‚ùå L·ªói load sheet</td></tr>`;
  }
}

function renderTable(rows) {
  const tbody = document.getElementById('tbody');
  tbody.innerHTML = '';

  rows.forEach((row, i) => {
    const email =
      row.email || row.Email || row.EMAIL || row.mail || row.Mail || '';

    const password =
      row.password || row.pass || row.Pass || row.mk || row.matkhau || '';

    if (!email || !password) return;

    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${i + 1}</td>
      <td>VSPhone</td>
      <td>${escapeHtml(email)}</td>
      <td>${escapeHtml(password)}</td>
      <td>
        <button class="btn" onclick="login('${email}','${password}')">
          üöÄ Login
        </button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function login(email, pass) {
  localStorage.setItem('VS_LOGIN_EMAIL', email);
  localStorage.setItem('VS_LOGIN_PASS', pass);
  window.open('https://cloud.vsphone.com/login', '_blank');
}

loadSheet();
</script>


</body>
</html>
