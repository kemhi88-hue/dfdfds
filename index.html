```html
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>VSPhone ‚Äì Qu·∫£n l√Ω t√†i kho·∫£n (CSV t·ª´ pubhtml)</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  color: #e5e7eb;
  padding: 20px;
  min-height: 100vh;
}
.container { max-width: 1200px; margin: 0 auto; }
h2 { font-size: 28px; margin-bottom: 10px; color: #22c55e; }
.note { font-size: 13px; color: #94a3b8; margin-bottom: 20px; }
.table-wrapper { background: #1e293b; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 12px 16px; text-align: left; border-bottom: 1px solid #334155; }
th { background: #0f172a; color: #22c55e; font-weight: 600; text-transform: uppercase; font-size: 12px; letter-spacing: 0.5px; }
tbody tr { transition: background 0.2s; }
tbody tr:hover { background: #334155; }
.status-active { color: #22c55e; font-weight: 600; }
.status-inactive { color: #ef4444; }
.btn { padding: 8px 16px; background: #22c55e; color: #022c22; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; transition: all 0.2s; font-size: 13px; }
.btn:hover { background: #16a34a; transform: translateY(-1px); }
.loading { text-align: center; padding: 40px; color: #94a3b8; }
.error { color: #ef4444; background: #7f1d1d; padding: 12px; border-radius: 8px; }
.password-cell { font-family: 'Courier New', monospace; color: #94a3b8; }
.footer-note { margin-top: 20px; padding: 15px; background: #1e293b; border-radius: 8px; border-left: 4px solid #22c55e; }
.small { font-size: 12px; color: #94a3b8; }
</style>

<!-- PapaParse ƒë·ªÉ parse CSV an to√†n -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

<div class="container">
  <h2>üì± VSPhone ‚Äì Qu·∫£n l√Ω t√†i kho·∫£n (CSV t·ª´ pubhtml)</h2>
  <p class="note">D·ªØ li·ªáu load t·ª´ Google Sheets (link publish). Sheet ph·∫£i ƒë∆∞·ª£c Publish to web v√† public.</p>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>N·ªÅn t·∫£ng</th>
          <th>Email</th>
          <th>Password</th>
          <th>Tr·∫°ng th√°i</th>
          <th style="text-align: center;">Thao t√°c</th>
        </tr>
      </thead>
      <tbody id="tbody">
        <tr>
          <td colspan="5" class="loading">‚è≥ ƒêang t·∫£i d·ªØ li·ªáu...</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="footer-note">
    <strong>üìå H∆∞·ªõng d·∫´n nhanh</strong><br>
    1. ƒê·∫£m b·∫£o b·∫°n ƒë√£ Publish to web (File ‚Üí Publish to web).<br>
    2. N·∫øu link pubhtml c√≥ nhi·ªÅu sheet, th√™m `&gid=...` v√†o URL CSV n·∫øu c·∫ßn.<br>
    <span style="color:#fbbf24">‚ö†Ô∏è B·∫£o m·∫≠t</span> Public sheet = m·ªçi ng∆∞·ªùi c√≥ link ƒë·ªÅu xem ƒë∆∞·ª£c. Kh√¥ng l∆∞u d·ªØ li·ªáu nh·∫°y c·∫£m n·∫øu kh√¥ng mu·ªën c√¥ng khai.
  </div>
</div>

<script>
/* ================== C·∫§U H√åNH ================== */
/*
  B·∫°n ƒë√£ cung c·∫•p link publish d·∫°ng pubhtml:
  https://docs.google.com/spreadsheets/d/e/2PACX-1vSyIS6NTiGHKz7BR5e8PEshKhRJWJcUC9bR8Gp5_WuqfsEGOwRdaARGcR-CwV7Dn_gUYRxcZ12Yb20I/pubhtml

  ƒê·ªÉ l·∫•y CSV t·ª´ link publish, ta d√πng endpoint:
  https://docs.google.com/spreadsheets/d/e/<PUB_ID>/pub?output=csv
  N·∫øu c·∫ßn sheet c·ª• th·ªÉ, th√™m &gid=GID (v√≠ d·ª• &gid=0)
*/

// Thay ƒë·ªïi n·∫øu b·∫°n mu·ªën d√πng gid kh√°c
const PUB_BASE = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSyIS6NTiGHKz7BR5e8PEshKhRJWJcUC9bR8Gp5_WuqfsEGOwRdaARGcR-CwV7Dn_gUYRxcZ12Yb20I/pub';
const GID = '0'; // n·∫øu sheet c·ªßa b·∫°n c√≥ gid kh√°c, thay v√†o ƒë√¢y
const CSV_URL = `${PUB_BASE}?output=csv&gid=${GID}`;

/* ================== H√ÄM H·ªñ TR·ª¢ ================== */
function openLogin(email, password) {
  const encodedEmail = encodeURIComponent(email);
  const encodedPass = encodeURIComponent(password);
  const loginUrl = `https://cloud.vsphone.com/login?email=${encodedEmail}&pass=${encodedPass}`;
  window.open(loginUrl, '_blank');
}

function escapeHtml(s) {
  if (!s && s !== 0) return '';
  return String(s)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

/* ================== RENDER B·∫¢NG T·ª™ M·∫¢NG OBJECT ================== */
function renderTableFromObjects(rows) {
  const tbody = document.getElementById('tbody');
  tbody.innerHTML = '';

  if (!rows || rows.length === 0) {
    tbody.innerHTML = '<tr><td colspan="5" class="error">‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
    return;
  }

  // L·∫•y header keys t·ª´ object ƒë·∫ßu ti√™n
  const headerKeys = Object.keys(rows[0]).map(k => k.trim());

  // T√¨m c√°c tr∆∞·ªùng ph·ªï bi·∫øn (h·ªó tr·ª£ ti·∫øng Vi·ªát/Anh)
  const keyPlatform = headerKeys.find(k => /platform|n·ªÅn t·∫£ng|n·ªÅn_t·∫£ng/i.test(k)) || headerKeys[0];
  const keyEmail = headerKeys.find(k => /email/i.test(k));
  const keyPassword = headerKeys.find(k => /pass(word)?|m·∫≠t kh·∫©u|mat_khau/i.test(k));
  const keyStatus = headerKeys.find(k => /status|tr·∫°ng|trang thai|tr·∫°ng_th√°i/i.test(k)) || headerKeys[3] || '';

  let count = 0;
  rows.forEach(row => {
    const platform = row[keyPlatform] ?? 'VSPhone';
    const email = row[keyEmail] ?? '';
    const password = row[keyPassword] ?? '';
    const status = keyStatus ? (row[keyStatus] ?? '') : '';

    if (!email || !password) return; // b·ªè qua d√≤ng kh√¥ng h·ª£p l·ªá
    count++;

    const statusClass = /active|ho·∫°t|online|on/i.test(status) ? 'status-active' : 'status-inactive';

    const pEsc = escapeHtml(platform);
    const eEsc = escapeHtml(email);
    const sEsc = escapeHtml(status);
    const pwdDots = '‚Ä¢'.repeat(String(password).length);

    const emailForClick = encodeURIComponent(email);
    const passForClick = encodeURIComponent(password);

    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><strong>${pEsc}</strong></td>
      <td>${eEsc}</td>
      <td class="password-cell">${pwdDots}</td>
      <td class="${statusClass}">${sEsc}</td>
      <td style="text-align: center;">
        <button class="btn" data-email="${emailForClick}" data-pass="${passForClick}">üöÄ LOGIN</button>
      </td>
    `;
    tr.querySelector('.btn').addEventListener('click', function() {
      const em = decodeURIComponent(this.getAttribute('data-email'));
      const pw = decodeURIComponent(this.getAttribute('data-pass'));
      openLogin(em, pw);
    });

    tbody.appendChild(tr);
  });

  if (count === 0) {
    tbody.innerHTML = '<tr><td colspan="5" class="loading">Kh√¥ng c√≥ t√†i kho·∫£n h·ª£p l·ªá</td></tr>';
  } else {
    console.log(`[VSP Manager] ‚úÖ Loaded ${count} accounts`);
  }
}

/* ================== T·∫¢I CSV V√Ä PARSE ================== */
async function loadDataFromCsv() {
  try {
    console.log('[VSP Manager] Fetching CSV...', CSV_URL);
    const res = await fetch(CSV_URL);
    if (!res.ok) {
      // N·∫øu server tr·∫£ HTML (v√≠ d·ª• redirect ho·∫∑c th√¥ng b√°o), show body snippet ƒë·ªÉ debug
      const bodyText = await res.text().catch(() => '');
      throw new Error(`HTTP ${res.status} ${res.statusText}. Response snippet: ${bodyText.slice(0, 300)}`);
    }
    const text = await res.text();

    // D√πng PapaParse ƒë·ªÉ parse CSV an to√†n
    const parsed = Papa.parse(text, {
      header: true,
      skipEmptyLines: true,
      dynamicTyping: false,
      transformHeader: h => h.trim()
    });

    if (parsed.errors && parsed.errors.length > 0) {
      console.warn('[VSP Manager] CSV parse warnings/errors', parsed.errors);
    }

    const rows = parsed.data; // m·∫£ng object
    renderTableFromObjects(rows);

  } catch (err) {
    console.error('[VSP Manager] CSV load error', err);
    document.getElementById('tbody').innerHTML =
      `<tr><td colspan="5" class="error">‚ùå L·ªói: ${escapeHtml(err.message)}<br><small>Ki·ªÉm tra link publish, ƒë·∫£m b·∫£o sheet ƒë√£ Publish to web v√† public</small></td></tr>`;
  }
}

/* ================== KH·ªûI ƒê·ªòNG ================== */
loadDataFromCsv();
</script>

</body>
</html>
```
